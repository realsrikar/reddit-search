"use strict";var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),_templateObject=_taggedTemplateLiteral(['\n    <section class="post">\n      <span class="score d-block">\n      <img src="img/updoot.png" width="15" style="margin-right: .25em; transform: translate(2px, -1px);">\n      ','\n      </span>\n\n      <a data-target="_blank" rel="nofollow noopener noreferrer" href="https://reddit.com/u/','">u/','</a>:\n\n      "','"\n          <span class="info d-block my-2">\n            <a href="https://reddit.com/','" data-target="_blank"  rel="nofollow noopener noreferrer">','</a>\n\n            &mdash;\n\n            <a data-target="_blank" rel="nofollow noopener noreferrer" href="https://reddit.com','">Comments</a>\n          </span>\n\n\n          <span class="text-warning gold ','">\n            '," &times;\n          </span>\n\n        ","\n        ","\n\n    </section>"],['\n    <section class="post">\n      <span class="score d-block">\n      <img src="img/updoot.png" width="15" style="margin-right: .25em; transform: translate(2px, -1px);">\n      ','\n      </span>\n\n      <a data-target="_blank" rel="nofollow noopener noreferrer" href="https://reddit.com/u/','">u/','</a>:\n\n      "','"\n          <span class="info d-block my-2">\n            <a href="https://reddit.com/','" data-target="_blank"  rel="nofollow noopener noreferrer">','</a>\n\n            &mdash;\n\n            <a data-target="_blank" rel="nofollow noopener noreferrer" href="https://reddit.com','">Comments</a>\n          </span>\n\n\n          <span class="text-warning gold ','">\n            '," &times;\n          </span>\n\n        ","\n        ","\n\n    </section>"]),_templateObject2=_taggedTemplateLiteral(['\n      <div class="self-text">\n      <button class="collapse-icon btn btn-none self-text-btn"></button>\n      <span class="text">',"</span>\n      </div>"],['\n      <div class="self-text">\n      <button class="collapse-icon btn btn-none self-text-btn"></button>\n      <span class="text">',"</span>\n      </div>"]),_templateObject3=_taggedTemplateLiteral(['\n          <video playsinline autoplay controls heigth="','" width="','">\n          <source src="','" type="video/mp4">\n          </video>\n          '],['\n          <video playsinline autoplay controls heigth="','" width="','">\n          <source src="','" type="video/mp4">\n          </video>\n          ']),_templateObject4=_taggedTemplateLiteral(['\n          <img heigth="','" width="',' src="','" type="image/gif" />'],['\n          <img heigth="','" width="',' src="','" type="image/gif" />']),_templateObject5=_taggedTemplateLiteral(['<div class="self-text">\n        <button class="collapse-icon btn btn-none gif-toggle" data-ht="','" data-wt="','" data-url="','" data-type="mp4"></button>\n      <span class="text"></span>\n      </div>'],['<div class="self-text">\n        <button class="collapse-icon btn btn-none gif-toggle" data-ht="','" data-wt="','" data-url="','" data-type="mp4"></button>\n      <span class="text"></span>\n      </div>']),_templateObject6=_taggedTemplateLiteral(['<div class="slef-text">\n      <button class="collapse-icon btn btn-none gif-toggle" data-ht="','" data-wt="','" data-url="','" data-type="gif"></button>\n      <span class="text"></span>\n      </div>'],['<div class="slef-text">\n      <button class="collapse-icon btn btn-none gif-toggle" data-ht="','" data-wt="','" data-url="','" data-type="gif"></button>\n      <span class="text"></span>\n      </div>']),_templateObject7=_taggedTemplateLiteral(['\n    <a data-target="_blank" class="post-link" rel="nofollow noopener noreferrer" href="','">\n      <img class="thumb-img" src="','" style="max-height: ','" class="d-block mx-auto">\n      <p class="img-domain">',"</p>\n    </a>"],['\n    <a data-target="_blank" class="post-link" rel="nofollow noopener noreferrer" href="','">\n      <img class="thumb-img" src="','" style="max-height: ','" class="d-block mx-auto">\n      <p class="img-domain">',"</p>\n    </a>"]);function _taggedTemplateLiteral(t,e){return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./sw.js").then(function(){console.log("thanks")},function(t){return console.log(t)})});var html=String.raw,Search=function(){function t(){_classCallCheck(this,t),this.params={query:"",limit:10,sort:"confidence"},this.els={container:document.querySelector(".container"),form:document.querySelector("form"),input:document.querySelector("input"),close:document.querySelector(".close"),collapseIcon:"",sortSelect:document.querySelector("select")},this.vals={original:"",queryArray:[]},this.getFromLS(),this.setCloseState(),this.AEL(),this.collapse()}return _createClass(t,[{key:"decodeHtml",value:function(t){var e=document.createElement("textarea");return e.innerHTML=t,e.value}},{key:"setCloseState",value:function(){null==this.els.input.value||null==this.els.input.value||""==this.els.input.value?this.els.close.style.display="none":this.els.close.style.display="block"}},{key:"getFromLS",value:function(){if(localStorage.getItem("query")){var t=localStorage.getItem("query");this.els.input.value=JSON.parse(t)[0],this.fetchData(JSON.parse(t)[0])}}},{key:"saveToStorage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.vals.queryArray=[t],localStorage.setItem("query",JSON.stringify(this.vals.queryArray)),this.fetchData(JSON.parse(localStorage.getItem("query"))[0])}},{key:"fetchData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e&&""!=e&&fetch("https://www.reddit.com/search.json?limit="+this.params.limit+"&q="+encodeURI(e)+"&sort="+this.params.sort).then(function(t){if(t.ok)return t}).then(function(t){return t}).then(function(t){return t.json()}).then(function(t){return t.data.children}).then(function(e){e.forEach(function(e,n){1==n?t.els.container.innerHTML=t.textDefault(e):t.els.container.innerHTML+=t.textDefault(e)})}).catch(function(e){return t.err=e})}},{key:"textDefault",value:function(t){return html(_templateObject,t.data.score.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),t.data.author,t.data.author,t.data.title,t.data.subreddit_name_prefixed,t.data.subreddit_name_prefixed,t.data.permalink,0!=t.data.gilded?"d-block":"d-none",0!=t.data.gilded?t.data.gilded:"",this.thisText(t),this.preview(t.data.preview,t.data.url,t.data))}},{key:"thisText",value:function(t){return t.data.thistext_html?html(_templateObject2,this.decodeHtml(t.data.thistext_html)):""}},{key:"AEL",value:function(){var t=this;this.els.form.addEventListener("submit",function(e){t.els.container.innerHTML="",t.setCloseState(),t.els.input.blur(),t.getData(e)}),this.els.input.addEventListener("keyup",function(e){t.setCloseState(),"ontouchstart"in window||t.getData(e)}),this.els.close.addEventListener("click",function(e){return t.resetData(e)}),this.els.sortSelect.addEventListener("change",function(e){return t.sortChange(e)})}},{key:"sortChange",value:function(t){this.params.sort=t.target.options[t.target.selectedIndex].value,this.fetchData(this.els.input.value)}},{key:"getData",value:function(t){t.keyCode>36&&t.keyCode<41||32==t.keyCode||91==t.keyCode||9==t.keyCode||2==t.keyCode||t.keyCode>15&&t.keyCode<21||(this.vals.original.length>512?this.els.container.innerHTML="<h1>Query may not be longer than 512 characters</h1>":(t.preventDefault(),this.vals.original=this.els.input.value,this.fetchData(this.vals.original),this.saveToStorage(this.vals.original)))}},{key:"resetData",value:function(t){this.els.form.reset(),this.els.container.innerHTML="",t.target.style.display="none",this.params.sort="confidence",this.els.input.focus(),this.saveToStorage()}},{key:"collapse",value:function(){this.els.collapseIcon=document.querySelectorAll(".collapse-icon"),this.els.container.addEventListener("click",function(t){t.target.classList.contains("collapse-icon")&&(t.target.parentElement.classList.toggle("open"),t.target.classList.contains("gif-toggle")?"mp4"==t.target.dataset.type&&(t.target.nextElementSibling.innerHTML=html(_templateObject3,t.target.dataset.ht,t.target.dataset.wt,t.target.dataset.url)):"gif"==t.target.dataset.type&&(t.target.nextElementSibling.innerHTML=html(_templateObject4,t.target.dataset.ht,t.target.dataset.wt,t.target.dataset.url)))})}},{key:"preview",value:function(t,e,n){if(!t)return"";if(t.images[0].variants.mp4){var a=t.images[0].variants.mp4.source,s={ht:a.height,wt:a.width,url:a.url};return html(_templateObject5,s.ht,s.wt,s.url)}if(t.images[0].variants.gif){var r=t.images[0].variants.gif.source,l={ht:r.height,wt:r.width,url:r.url};return html(_templateObject6,l.ht,l.wt,l.url)}var i=t.images[0].source,o={ht:i.height,url:i.url};return html(_templateObject7,e,o.url,o.ht/9*16+"px",n.domain)}}]),t}();new Search;
//# sourceMappingURL=bundle.js.map
